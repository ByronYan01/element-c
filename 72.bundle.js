"use strict";(self.webpackChunksf_ui=self.webpackChunksf_ui||[]).push([[72],{4475:function(e,t,n){var o=n(3645),i=n.n(o)()((function(e){return e[1]}));i.push([e.id,".dragDropArea[data-v-6db4e6db]{width:300px;height:200px;border:1px solid #b8860b}",""]),t.Z=i},6072:function(e,t,n){n.r(t),n.d(t,{default:function(){return c}});var o=n(2861),i={name:"oss",components:{},data(){return{uploadFlag:!1,url:"",blockContentList:{},lenLimit:10,sizeLimit:1048576}},computed:{showUploadList(){return console.log("ssss===this.blockContentList==",this.blockContentList),Object.values(this.blockContentList).map((e=>e[0]))}},mounted(){},methods:{clickUploadFuc(){this.uploadFlag=!0},onCancel(){this.uploadFlag=!1},errHanlder(e){"size"===e.message&&this.$message.warning("存在文件超过 1 M")},dragoverFuc(e){console.log("dragoverFuc e.type===",e.type)},dragleaveFuc(e){console.log("dragleaveFuc e.type===",e.type)},dropFuc(e){console.log("dropFuc e.target.files===",e.target),console.log("dropFuc e.dataTransfer.files===",e.dataTransfer),console.log("dropFuc e.dataTransfer.items===",e.dataTransfer.items),this.addDataTransfer(e.dataTransfer)},addDataTransfer(e){if(e?.items?.length){const t=[];for(let n=0;n<e.items.length;n++){const o=e.items[n];let i;i=o.getAsEntry?o.getAsEntry()||o.getAsFile():o.webkitGetAsEntry&&o.webkitGetAsEntry()||o.getAsFile(),i&&t.push(i)}return this.getFileSystemEntry(t).then((e=>{console.log("files===",e),e.filter((e=>"text/directory"!==e.type)).length>this.lenLimit?this.$message.warning("文件数量超过"):this.blockContentList=e}),(e=>{this.errHanlder(e),console.log("err===",e)}))}},getBlockContent(e){return new Promise((t=>{const n={},o=i=>{const r=e[i];if(!r)return t(n);this.getFileSystemEntry(r,"").then((function(e){console.log("getBlockContent results===",e),n[e[0]?.name]=e,o(i+1)}),(e=>{this.errHanlder(e)}))};o(0)}))},getFileSystemEntry(e,t=""){return new Promise(((n,o)=>{if(e)if(e instanceof Array){const o=[],i=r=>{const s=e[r];if(!s)return n(o);this.getFileSystemEntry(s,t).then((function(e){o.push(...e),i(r+1)}),(e=>{this.errHanlder(e),console.log("err===",e)}))};i(0)}else if(e.isFile)e.file((e=>{e.size>this.sizeLimit&&o(new Error("size")),n([{id:"",size:e.size,name:t+e.name,type:e.type,file:e}])}));else if(e.isDirectory){let o=e;const i=[],r={id:"",name:t+o.name,size:0,totolSize:0,type:"text/directory",file:new File([],t+o.name,{type:"text/directory"})};i.push(r);const s=o.createReader(),l=()=>{s.readEntries((e=>{const s=a=>e[a]||0!==a?e[a]?void this.getFileSystemEntry(e[a],t+o.name+"/").then((function(e){i.push(...e);const t=e[0];let n=e[0]?.size??0;"text/directory"==t.type&&(n=e[0]?.totolSize),r.totolSize=r.totolSize+n,s(a+1)}),(e=>{this.errHanlder(e),console.log("err===",e)})):l():n(i);s(0)}))};l()}else n([]);else n([])}))},filterSize(e){return e?e<this.pow1024(1)?e+" B":e<this.pow1024(2)?(e/this.pow1024(1)).toFixed(2)+" KB":e<this.pow1024(3)?(e/this.pow1024(2)).toFixed(2)+" MB":e<this.pow1024(4)?(e/this.pow1024(3)).toFixed(2)+" GB":(e/this.pow1024(4)).toFixed(2)+" TB":""},pow1024(e){return Math.pow(1024,e)},inputChangeList(e){console.log("event===",e),console.log("event.target.files===",e.target.files),this.uploadFuc(e.target.files)},inputChange(e){console.log("event===",e),console.log("event.target.files===",e.target.files),this.uploadFuc(e.target.files)},uploadFuc(e){const t=new FormData;for(let n=0,o=e.length;n<o;n++){const o=e[n];t.append(o.name,o)}console.log("form===",t),o.Z.put(this.url,t,{headers:{"Content-Type":"multipart/form-data"}}).then((e=>{console.log("res===",e)}))}}},r=n(3379),s=n.n(r),l=n(4475),a=(s()(l.Z,{insert:"head",singleton:!1}),l.Z.locals,(0,n(1900).Z)(i,(function(){var e=this,t=e._self._c;return t("div",[e._v("\n  123\n  "),t("el-button",{on:{click:e.clickUploadFuc}},[e._v("上传")]),t("el-input",{model:{value:e.url,callback:function(t){e.url=t},expression:"url"}}),t("input",{attrs:{id:"files1",type:"file",multiple:""},on:{change:e.inputChange}}),t("input",{attrs:{id:"files2",type:"file",multiple:"",webkitdirectory:""},on:{change:e.inputChangeList}}),t("div",{ref:"dragDropArea",staticClass:"dragDropArea",on:{dragover:function(t){return t.stopPropagation(),t.preventDefault(),e.dragoverFuc.apply(null,arguments)},dragleave:function(t){return t.stopPropagation(),t.preventDefault(),e.dragleaveFuc.apply(null,arguments)},drop:function(t){return t.stopPropagation(),t.preventDefault(),e.dropFuc.apply(null,arguments)}}}),e._l(e.blockContentList,(function(n){return t("div",{key:n},[e._v("\n    "+e._s(n.name+"  ---  "+e.filterSize(n.totolSize||n.size))+"\n  ")])}))],2)}),[],!1,null,"6db4e6db",null)),c=a.exports}}]);